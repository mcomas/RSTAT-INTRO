---
title: "Introduction to R"
output: 
  ioslides_presentation: 
    smaller: yes
    fontsize: 12pt
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# R and RStudio

## The R Project for Statistical Computing

* R is a programming language for statistical computing, specifically designed for data analysis.
* The main implementation is the one available at the __The Comprehensive R Archive Network__ (CRAN). 
  * Other implementations exist:  __Microsoft R Open__ (MRAN), __TIBCO® Enterprise Runtime for R__  (TERR), ...
* R (CRAN) runs on Unix-like systems, Windows and Mac.
* R (CRAN) can be download at <https://cran.r-project.org>.


## RStudio Desktop

* RStudio Desktop is a free integrated development environment (IDE) for R.
* It incorporates: 
  * A __`Console`__ pane to execute instructions interactively.
  * An __`Environment`__ pane to control existing variables.
  * An R script editor. Supporting other languages: `html`, `css`,  `markdown`, `python`, `C/C++`, ...
* RStudio Desktop can be download at <https://rstudio.com/products/rstudio/download/>.

* Other existing IDEs: R tools (in Visual Studio), StatET for R (in Eclipse), Jupyter, ... or any text editor: Emacs, Atom, Visual Studio Code, ...

# Introduction to R

## Vectors

* __Atomic vectors__.
    * `logical`, 
    * `integer`, 
    * `numeric`, 
    * `character`, and also
    * `raw` and `complex`.
    * Coercing order: `logical` $\rightarrow$ `integer`  $\rightarrow$ `numeric` $\rightarrow$ `character`
* __Lists__.

Arrays (`array`) and matrices (`matrix`) are dimensional vectors.

## Non-avaliable value `NA`

* `NA` is a symbol to defined non-availiable observation.
* We can operate with `NA`:

```{r, collapse=TRUE}
NA + 3
NA ^ 0
NA | FALSE
NA | TRUE
mean( c(1, 3, 2, NA) )
```

## Functions {.smaller}

Structure:

```r
my_function <- function(...){
  ...
  # Some code
  ...
  return(some_result)
}
```

It is common to avoid the `return()` statement:

```r
my_function <- function(...){
  ...
  # Some code
  ...
  some_result
}
```
<!--

## Executing R scripts

* From RStudio:
  * Line by line execution (Ctrl+Enter)
  * Run all script (Ctrl+Alt+R)
  * More options in "Run" menu.
* Calling the script within R: `source("script_file.R")`
* Calling from system's terminal: `Rscript script_file.R`
-->


## Operators in R

* __Arithmetic__. Addition (`+`), substraction (`-`), multiplication (`*`), division (`/`), and exponentiation (`^`).
    * Modulus (`%%`) and integer division (`%/%`).
* __Logical__. and (`&`), or (`|`).
    * Comparisons: lower than (`<`), greater than (`>`), lower or equal than (`<=`), greater or equal than (`>=`), equal to (`==`), not equal to (`!=`), is in (`%in%`).

## Vector selection {.smaller}

* Positive integers

    ```{r, eval=FALSE}
    month.abb[c(1,3,5,7,9,11)]
    ```

* Negative integers

    ```{r, eval=FALSE}
    month.abb[c(-1,-3,-5,-7,-9,-11)]
    ```

* Logical vectors

    ```{r, eval=FALSE}
    month.abb[c(T,F,T,F,T,F,T,F,T,F,T,F)]
    ```

* Vector of names (only with named vectors)

    ```{r, eval=FALSE}
    x = 1:12
    names(x) = month.abb
    x[c("Jan", "Mar", "May", "Jul", "Sep", "Nov")]
    ```

## Iteration in R {.smaller}

* For-structure:

```r
for(i in S){
  ...
  # Some code
  ...
}
```

* Functional iteration: <br><br>
`sapply(x, f)`, `lapply(x, f)`<br>
`mapply(f, x1, x2, ...)`

## Activities {data-background=#CCE5FF}

* Suppose `queue = c("Maria", "Josep", "Marçal", "Lluïsa")` represents a supermarket queue, with Maria first in line. Using R expressions update the supermarket queue:
    1. Manel arrives;
    2. Maria is served;
    3. Vicens talks her way to the front with one item;
    4. Manel gets impatient and leaves;
    5. Marçal gets impatient and leaves;


```{r, eval=FALSE, echo=FALSE}
queue = c("Maria", "Josep", "Marçal", "Lluïsa")
queue = c(queue, "Manel")
queue
queue = queue[-1]
queue
queue = c("Vicens", queue)
queue
queue = queue[1:4]
queue
queue = queue[-3]
queue
```

* Why is `1 == "1"` true? Why is `-1 < FALSE` true? Why is `"one" < 2` false?

* Why is the default missing value, `NA` (see `is.logical(NA)`), a logical vector? What's special about logical vectors? (Hint: think about `c(FALSE, NA_character_)`.)

# Repositories and packages

## R packages {.smaller}

```{r, echo=FALSE, out.width="80%", fig.align='center', fig.cap="<br><br>[CRAN](https://cran.r-project.org/web/packages/) and [Bioconductor](https://www.bioconductor.org/) are the main package repositories of R. <br/>[Github](http://github.com) contains lots of packages."}
knitr::include_graphics('repositories.png')
```

## Installing new packages

* Packages on CRAN can be installed using function `install.packages()`.

    ```{r, eval=FALSE}
    install.packages("<PACKAGE NAME>")
    ```

* Other sources:

    * In Bioconductor:

    ```{r, eval=FALSE}
    BiocManager::install("<PACKAGE NAME>")
    ```

    * Github:

    ```{r, eval=FALSE}
    remotes::install_github("<REPOSITORY NAME>")
    ```

* In RStudio, inside `Packages` pane:
    * Install new packages  using _Install_ menu.
    
# Importing and exporting data

## Packages to import/export data

* `readr`: Read Rectangular Text Data<br />
 <https://cran.r-project.org/web/packages/readr/index.html>
* `readxl`: Read Excel Files<br />
 <https://cran.r-project.org/web/packages/readxl/index.html>
* `writexl`: Export Data Frames to Excel 'xlsx' Format<br />
 <https://cran.r-project.org/web/packages/writexl/index.html>
* `haven`: Import and Export 'SPSS', 'Stata' and 'SAS' Files<br />
 <https://cran.r-project.org/web/packages/haven/index.html>

More:

* `googlesheets4`: Access Google Sheets using the Sheets API V4<br />
 <https://cran.r-project.org/web/packages/googlesheets4/index.html>
* `Microsoft365R`: Interface to the 'Microsoft 365' Suite of Cloud Services<br />
 <https://cran.r-project.org/web/packages/Microsoft365R/index.html>

## RData files

* To save different R objects into a file.

```{r, eval=FALSE}
save(..., file = "filename.RData")
```

Example. Saving objects `table01` and `vector2` into a file named `my_file.RData`.

```{r, eval=FALSE}
save(table01, vector2, file = 'my_file.RData')
```

* To recover a saved RData file,

```{r, eval=FALSE}
load("filename.RData")
```

## `readr`: Read Rectangular Text Data

* `read_csv()`, `read_csv2()` and  `read_delim()`

* In RStudio, inside `Environment` pane:
    * Import a text file using _Import Dataset $\rightarrow$ From Text (`readr`)_ menu.
    * __Avoid__ importing using _Import Dataset $\rightarrow$ From Text (`base`)_ menu.


## `readxl`: Read Excel Files

* In RStudio, inside `Environment` pane:
    * Import an excel file using _Import Dataset $\rightarrow$ From Excel_ menu.
    
## `haven`: 'SPSS', 'Stata' and 'SAS' Files

* In RStudio, inside `Environment` pane:
    * Import a file from another statistical software using _Import Dataset $\rightarrow$ From SPSS_ or _From SAS_ or _From Stata_ menus.
    